@UI
@UISINGLEVOUCHERGENERATE

Feature: Generate single vouchers on campaigns

# **************************************************************************************
#  -------------------------------- Generate SUNT Vouchers-------------------------------
#  **************************************************************************************

  Scenario: Generate single voucher on SUNT campaigns (happy path)
    Given I create the campaign
         """
         {
         	"type":"SINGLE_USE_NON_TRANSFERABLE",
            "name":"SUNT Campaign",
            "prefix":"NOW",
            "cancelled":false,
            "pomOfferId":"12346",
            "secondaryOfferId":"abc123",
            "start":"2014-06-26T00:00:00Z",
            "end":"2016-06-26T00:00:00Z",
            "cap":"20"
         }
         """
    And I go to the List Campaigns page
    Then the browser is at the List Campaigns page
    And I click on the campaign we just created
    And I click on the Show Create Vouchers link
    When I enter the values
      | accountId          | 11111111 |
      | requestedAccountId | 22222222 |
      | caseNumber         | 33333333 |
    And I click the Create Voucher button
    Then the text "Created Voucher" is displayed on the page

    And  I wait for all campaign batches to change state from PENDING
    Then the table has the following headers with corresponding first row values
      | State        | READY        |
      | Generated By | admin        |
      | Cancel Batch | Cancel Batch |
      | Export       | Export       |
      | History      | History      |
      | Vouchers     | 1            |
      | Redeemed     | 0            |
      | History      | History      |

 #**************************************************************************************
 # -------------------------------- Generate SUT Vouchers-------------------------------
 # **************************************************************************************

  Scenario: Generate single voucher on SUT campaign with/without Case Number and Account ID
    Given I create the campaign
         """
         {
         	"type":"SINGLE_USE_TRANSFERABLE",
            "name":"SUT Campaign",
            "prefix":"NOW",
            "cancelled":false,
            "pomOfferId":"12346",
            "secondaryOfferId":"abc123",
            "start":"2014-06-26T00:00:00Z",
            "end":"2016-06-26T00:00:00Z",
            "cap":"20"
         }
         """
    And I go to the List Campaigns page
    Then the browser is at the List Campaigns page
    And I click on the campaign we just created
    And I click on the Show Create Vouchers link
    When I enter the values
      | caseNumber         | 33333333 |
      | requestedAccountId | 22222222 |
    And I click the Create Voucher button
    Then the text "Created Voucher" is displayed on the page

    And  I wait for all campaign batches to change state from PENDING
    Then the table has the following headers with corresponding first row values
      | State        | READY        |
      | Generated By | admin        |
      | Cancel Batch | Cancel Batch |
      | Export       | Export       |
      | History      | History      |
      | Vouchers     | 1            |
      | Redeemed     | 0            |
      | History      | History      |

    And I click on the Hide Create Vouchers link
    And I click on the Show Create Vouchers link
    When I enter the values
      | caseNumber | 33333333 |
    And I click the Create Voucher button
    Then the text "Created Voucher" is displayed on the page

    And  I wait for all campaign batches to change state from PENDING
    Then the table has the following headers with corresponding first row values
      | State        | READY        |
      | Generated By | admin        |
      | Cancel Batch | Cancel Batch |
      | Export       | Export       |
      | History      | History      |
      | Vouchers     | 1            |
      | Redeemed     | 0            |
      | History      | History      |

 #**************************************************************************************
 # -------- Gifting campaign does not allow Single Voucher Creations SUT Vouchers--------
 # **************************************************************************************

  Scenario: Gifting campaign should not have an option to generate single voucher
    Given I create the campaign
         """
         {
         	"type":"GIFTING",
            "name":"GIFTING Campaign",
            "prefix":"NOW",
            "cancelled":false,
            "pomOfferId":"12346",
            "secondaryOfferId":"abc123",
            "start":"2014-06-26T00:00:00Z",
            "end":"2016-06-26T00:00:00Z",
            "cap":"20"
         }
         """
    And I go to the List Campaigns page
    Then the browser is at the List Campaigns page
    And I click on the campaign we just created
    And I click on the Show Create Vouchers link
    When the following elements are not be displayed
      | accountId          |
      | requestedAccountId |
      | caseNumber         |


# **************************************************************************************
#  -------- Promo campaign does not allow Single Voucher Creations SUT Vouchers--------
#  **************************************************************************************

  Scenario: Gifting campaign should not have an option to generate single voucher
    Given I create the campaign
         """
         {
         	"type":"PROMO_CODE",
            "name":"PROMO Code Campaign",
            "prefix":"NOW",
            "cancelled":false,
            "pomOfferId":"12346",
            "secondaryOfferId":"abc123",
            "start":"2014-06-26T00:00:00Z",
            "end":"2016-06-26T00:00:00Z",
            "cap":"20"
         }
         """
    And I go to the List Campaigns page
    Then the browser is at the List Campaigns page
    And I click on the campaign we just created
    When the following elements are not be displayed
      | accountId          |
      | requestedAccountId |
      | caseNumber         |